# generated

# OKS Map - Карта объектов капитального строительства Москвы

Проект для анализа и визуализации данных об объектах капитального строительства (ОКС) в Москве с использованием геокодирования и кластеризации застройщиков.

## Описание проекта

Проект собирает данные об объектах капитального строительства города Москвы различного уровня контроля, получает их координаты через Яндекс.Карты API и создает интерактивную карту с кластеризацией застройщиков.

## Структура проекта

```
OKS map/
├── Core_create_data.py      # Основной модуль для создания и обработки данных
├── Get_coord.py            # Модуль для получения координат через Яндекс API
├── Read_data.py            # Модуль для чтения данных из Excel файлов
├── Handy_func.py           # Вспомогательные функции (таймер)
├── main.ipynb              # Jupyter notebook для визуализации карты
├── MSK/                    # Папка с исходными данными
│   ├── DDY.xlsx           # Данные ДДУ (договоры долевого участия)
│   ├── FedNadzor.xlsx     # Данные федерального надзора
│   ├── RegNadzor.xlsx     # Данные регионального надзора
│   └── source.txt         # Ссылка на источник данных
├── save.xlsx              # Промежуточный файл с данными и координатами, чтобы не тратить апишку лишний раз
├── total.xlsx             # Финальный файл с обработанными данными
├── visual.html            # HTML карта объектов
└── visual_clusters.html   # HTML карта с кластеризацией застройщиков
```

## Функциональность

### 1. Сбор данных (`Read_data.py`)
- Чтение данных из Excel файлов 
- Объединение данных в единый датафрейм
- Стандартизация названий колонок

### 2. Геокодирование (`Get_coord.py`)
- Получение координат адресов через Яндекс.Карты API
- Валидация координат
- Обработка ошибок и повторные попытки

### 3. Обработка данных (`Core_create_data.py`)
- **create_data()**: Получение координат для всех адресов
- **clean_data()**: Фильтрация данных по географическим границам Москвы
- **Try_2_cluster()**: Кластеризация застройщиков по схожести названий

### 4. Визуализация (`main.ipynb`)
- Создание интерактивных карт с помощью Folium
- Отображение объектов с кластеризацией
- Цветовое кодирование застройщиков

## Источники данных

Данные получены с официального сайта Стройнадзора Москвы:
- **ДДУ**: Договоры долевого участия
- **Феднадзор**: Федеральный надзор
- **Регнадзор**: Региональный надзор

Источник: https://www.mos.ru/stroinadzor/reestr-obektov-kapitalno-stroitelstva/

## Установка и запуск

### Требования
```bash
pip install pandas numpy scikit-learn rapidfuzz geopy folium tqdm rioxarray
```

### Настройка API ключа
В файле `Get_coord.py` необходимо указать ваш API ключ Яндекс.Карт:
```python
api_key = "ваш-ключ-яндекс-карт"
```

### Запуск
1. **Создание данных**:
   ```python
   from Core_create_data import create_data, clean_data, Try_2_cluster
   
   create_data()    # Получение координат
   clean_data()     # Очистка данных
   Try_2_cluster() # Кластеризация
   ```

2. **Визуализация**:
   Запустите `main.ipynb` для создания интерактивных карт.

## Особенности

- **Географическая фильтрация**: Данные фильтруются по границам Москвы (широта: 55-57°, долгота: 37-38.6°)
- **Кластеризация застройщиков**: Использует алгоритм Agglomerative Clustering с метрикой схожести названий
- **Предобработка названий**: Удаление ОПФ, специальных символов для улучшения качества кластеризации
- **Интерактивные карты**: Создание HTML файлов с интерактивными картами Folium

## Результаты

Проект создает:
- `total.xlsx` - обработанные данные с координатами и кластерами
- `visual.html` - карта всех объектов
- `visual_clusters.html` - карта с кластеризацией застройщиков

## Статистика

- Обработано ~2500 объектов
- Успешность геокодирования: ~98%
- Кластеризация застройщиков по схожести названий
- Время обработки: ~5 минут для получения координат



